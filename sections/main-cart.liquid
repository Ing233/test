{%- liquid
  assign continue_shopping_page = routes.all_products_collection_url
  if section.settings.continue_shopping_page != blank
    assign continue_shopping_page = section.settings.continue_shopping_page
  endif
-%}

<div class="central py-medium content" data-section-type="cart-template">
  {% if section.settings.cart_show_title %}
  <h1 data-cc-animate class="h2" style="margin-bottom: 15px;">{{ 'cart.general.title' | t }}</h1>
  {% endif %}

  {% if cart.item_count > 0 %}

  <form action="{{ routes.cart_url }}" method="post" id="cartform" data-cc-animate>

    <div>
      <div class="added-to-cart" style="font-size: 1.25rem;line-height: 1.4;font-weight: 600;padding-top: 15px;margin-bottom: 0.8em;font-family: &quot;Neuzeit Office&quot;, sans-serif;">
          <span class="label">Added to cart</span>
        </div>
      <ul class="cart-list clearfix">

        {% comment %} <li class="item cart-list-header">
          <div class="col-image">{{ 'cart.general.product' | t }}</div>
          <div class="col-notimage">
              <div class="desc"></div>
              <div class="item-price">{{ 'cart.general.price' | t }}</div>
              <div class="quantity-and-remove">{{ 'cart.general.quantity' | t }}</div>
              <div class="line-total">{{ 'cart.general.total' | t }}</div>
          </div>
        </li> {% endcomment %}

        {% for item in cart.items %}

        {% comment %}
        Determining the handle of the collection that was last seen for the 'continue shopping' link.
        {% endcomment %}

        <li class="item clearfix">
          <div class="col-image">
            <a data-cc-animate-click class="image" href="{{ item.url }}">
              {% render 'responsive-image', image: item.image %}
            </a>
          </div>
          <div class="col-notimage">
            <div class="desc">
              <div class="title">
                <a data-cc-animate-click href="{{ item.url }}">
                  <span class="product-title">{{ item.product.title }}</span>
                  <span class="low-opacity">{% unless item.product.has_only_default_variant %}{{ item.variant.title }}{% endunless %}</span>
                </a>
              </div>
              {% comment %}
              Line Item Properties
              {% endcomment %}
              {% if item.properties.size > 0 %}
              <div class="line-items">
                {% for p in item.properties %}
                {% unless p.last == blank %}
                {{ p.first }}:
                {% if p.last contains '/uploads/' %}
                <a data-cc-animate-click href="{{ p.last }}">{{ p.last | split: '/' | last }}</a>
                {% else %}
                {{ p.last }}
                {% endif %}
                <br />
                {% endunless %}
                {% endfor %}
              </div>
              {% endif %}


              {% if item.selling_plan_allocation %}
                <div class="subscription-description">
                  <p>{{ item.selling_plan_allocation.selling_plan.name }}</p>
                </div>
              {% endif %}

              {% if section.settings.show_backorder_text == true %}
                {% render 'backorder', variant: item.variant %}
              {% endif %}

              <div class="quantity border-radius-{{ settings.buttons_shape }}">
                <a class="minus" href="{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity={{ item.quantity | minus: 1 }}" aria-label="{{ 'cart.general.decrease' | t | escape }}"><span>&minus;</span></a>
                <input class="select-on-focus" type="text" size="2" id="updates_{{ item.id }}" name="updates[]" value="{{ item.quantity }}" aria-label="{{ 'cart.general.quantity' | t | escape }}" />
                <a class="plus" href="{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity={{ item.quantity | plus: 1 }}" aria-label="{{ 'cart.general.increase' | t | escape }}"><span>&plus;</span></a>
              </div>
            </div>

            {% comment %} <div class="item-price">
              {% if item.original_line_price > item.final_line_price %}
                <div class="original-price theme-money">{{ item.original_price | money }}</div>
                <div class="theme-money">{{ item.final_price | money }}</div>
              {% else %}
                <div class="theme-money">{{ item.final_price | money }}</div>
              {% endif %}

              {% render 'unit-price', variant: item %}

              {% if item.line_level_discount_allocations.size > 0 %}
                <ul class="cart-discount-list">
                {% for discount_allocation in item.line_level_discount_allocations %}
                  <li class="cart-discount">
                    <div class="cart-discount__label">{{ discount_allocation.discount_application.title }}</div>
                    <div class="cart-discount__amount">(-<span class="theme-money">{{ discount_allocation.amount | money }}</span>)</div>
                  </li>
                {% endfor %}
                </ul>
              {% endif %}
            </div> {% endcomment %}

            {% comment %} <div class="quantity-and-remove">
              <div class="quantity border-radius-{{ settings.buttons_shape }}">
                <a class="minus" href="{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity={{ item.quantity | minus: 1 }}" aria-label="{{ 'cart.general.decrease' | t | escape }}"><span>&minus;</span></a>
                <input class="select-on-focus" type="text" size="2" id="updates_{{ item.id }}" name="updates[]" value="{{ item.quantity }}" aria-label="{{ 'cart.general.quantity' | t | escape }}" />
                <a class="plus" href="{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity={{ item.quantity | plus: 1 }}" aria-label="{{ 'cart.general.increase' | t | escape }}"><span>&plus;</span></a>
              </div>

              <a class="remove" href="{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity=0">{{ 'cart.general.remove' | t | escape }}</a>
            </div> {% endcomment %}

            <div class="line-total">
              <div>
                {% if item.original_line_price != item.final_line_price %}
                  <div class="original-price theme-money">{{ item.original_line_price | money }}</div>
                  <div class="theme-money">{{ item.final_line_price | money }}</div>
                {% else %}
                  <div class="theme-money">{{ item.final_line_price | money }}</div>
                {% endif %}

                {% if item.line_level_discount_allocations.size > 0 %}
                  <ul class="cart-discount-list">
                  {% for discount_allocation in item.line_level_discount_allocations %}
                    <li class="cart-discount">
                      <div class="cart-discount__label low-opacity">{{ discount_allocation.discount_application.title }}</div>
                      <div class="cart-discount__amount low-opacity">(-<span class="theme-money">{{ discount_allocation.amount | money }}</span>)</div>
                    </li>
                  {% endfor %}
                  </ul>
                {% endif %}
              </div>

              <div>
                <a class="remove" href="{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity=0">{{ 'cart.general.remove' | t | escape }}</a>
              </div>
              
            </div>
          </div>
        </li>
        {% endfor %}

      </ul>

      <div class="update-continue" style="font-size: 80%;">
        <input class="update textbutton" type="submit" style="text-transform: capitalize;font-family: Roboto, sans-serif;font-size: 12px!important;font-weight: 400;" name="update" value="{{ 'cart.general.update' | t | escape }}" />
        <a data-cc-animate-click class="continue" href="{{ continue_shopping_page }}">{{ 'cart.general.continue' | t }}</a>
      </div>
    </div>
    

    {% comment %} <div class="update-continue">
      <input class="update textbutton" type="submit" name="update" value="{{ 'cart.general.update' | t | escape }}" />
      <a data-cc-animate-click class="continue" href="{{ continue_shopping_page }}">{{ 'cart.general.continue' | t }}</a>
    </div> {% endcomment %}

    <div class="under-cart">
      <div class="subtotal-row cart-price-detail desktop-only">
        {%- if cart.cart_level_discount_applications != blank -%}
          <ul class="cart-discount-list align-right">
            {%- for discount_application in cart.cart_level_discount_applications -%}
              <li class="cart-discount cart-discount--inline">
                <span class="cart-discount__label low-opacity">{{ discount_application.title }}</span>
                <span class="cart-discount__amount low-opacity">-<span class="theme-money">{{ discount_application.total_allocated_amount | money }}</span></span>
              </li>
            {%- endfor -%}
          </ul>
        {%- endif -%}

        <div class="subtotal">
          <span class="label">{{ section.settings.text_summary | escape }}</span>
        </div>
        <div class="original-total-price price-detail-row">
          <span class="label">{{ 'cart.general.subtotal' | t }} ( {{ cart.item_count }} item )</span>
          <span class="amount theme-money">{{ cart.original_total_price | money }}</span>
        </div>
        <div class="total-discount price-detail-row low-opacity">
          <span class="label">{{ section.settings.text_total_save | escape }}</span>
          <span class="amount theme-money">-{{ cart.total_discount | money }}</span>
        </div>
        <div class="total-price price-detail-row">
          <span class="label">{{ section.settings.text_total_price | escape }}</span>
          <span class="amount theme-money">{{ cart.total_price | money }}</span>
        </div>
        <div class="price-info low-opacity">
          {{ section.settings.total_price_info }}
        </div>
      </div>
      <div class="subtotal-row cart-price-detail mobile-only">
        <div class="subtotal price-detail-row">
          <span class="label">{{ section.settings.text_summary | escape }} ( {{ cart.item_count }} item )</span>
          <span class="amount theme-money">{{ cart.total_price | money }}</span>
        </div>
        <div class="price-info low-opacity">
          {{ section.settings.total_price_info }}
        </div>
      </div>

      {% if section.settings.cart_note_show %}
      <p class="note-area">
        <label for="note">{{ 'cart.label.note' | t }}</label>
        <textarea id="note" name="note">{{ cart.note }}</textarea>
      </p>
      {% endif %}

      {% if section.settings.cart_terms_show %}
      <p class="terms rte">
        <input type="checkbox" id="terms" />
        {% assign terms_url = section.settings.cart_terms_page %}
        {% capture terms_label_html %}<label for="terms">{{ 'cart.terms.agreement_html' | t: terms_url: terms_url }}</label>{% endcapture %}
        {% if section.settings.cart_terms_page == blank %}
        {{ terms_label_html | replace: '<a ', '<span ' | replace: '</a>', '</span>' }}
        {% else %}
        {{ terms_label_html }}
        {% endif %}
      </p>
      {% endif %}

      {% if section.settings.show_tax_and_shipping %}
        {%- capture taxes_shipping_checkout -%}
          {%- if cart.taxes_included and shop.shipping_policy.body != blank -%}
            {{ 'cart.general.taxes_included_and_shipping_policy_html' | t: link: shop.shipping_policy.url }}
          {%- elsif cart.taxes_included -%}
            {{ 'cart.general.taxes_included_but_shipping_at_checkout' | t }}
          {%- elsif shop.shipping_policy.body != blank -%}
            {{ 'cart.general.taxes_and_shipping_policy_at_checkout_html' | t: link: shop.shipping_policy.url }}
          {%- else -%}
            {{ 'cart.general.taxes_and_shipping_at_checkout' | t }}
          {%- endif -%}
        {%- endcapture -%}

        <div class="cart-policies rte">{{ taxes_shipping_checkout }}</div>
      {% endif %}

      <input type="submit" class="checkout-btn" name="checkout" value="{{ section.settings.checkout_btn | escape }}" />

      {% comment %}Paypal and Google checkout buttons{% endcomment %}
      {% if section.settings.show_additional_checkout_buttons and additional_checkout_buttons and section.settings.cart_terms_show == false %}
      <div class="additional-checkout-buttons">
        {{ content_for_additional_checkout_buttons }}
      </div>
      {% endif %}

      {% comment %} Payment Icons {% endcomment %}
      {% if section.settings.show_payment_icons %}
        <div class="payment-tips-and-icons">
          <div class="payment-tips low-opacity desktop-only" style="font-size: 80%;">
            Offer More payment options at checkout
          </div>
          <div class="payment-icons">
            {% for type in shop.enabled_payment_types %}
                {{ type | payment_type_svg_tag: class: 'section-footer__payment-icon' }}  
            {% endfor %}

            {% if section.settings.custom_payment_icon %}
              <img class="section-footer__payment-icon payment-icon--custom"
                  src="{{ section.settings.custom_payment_icon | img_url: '120x' }}"
                  alt="{{ section.settings.custom_payment_icon.alt }}"
                  width="{{ section.settings.custom_payment_icon.width }}"
                  height="{{ section.settings.custom_payment_icon.height }}"
              />
            {% endif %}
          </div>
        </div>

      {% endif %}
      
      <div class="continue-shoping low-opacity mb-show" style="font-size: 80%;text-decoration: underline;">
        <a data-cc-animate-click class="continue" href="{{ continue_shopping_page }}">{{ 'cart.general.continue' | t }}</a>
      </div>
    </div>

  </form>

  {% else %}

  <div>
    <div class="rte" data-cc-animate data-cc-animate-delay="0.4s">
      <p data-cc-animate data-cc-animate-delay="0.2s" class="align-center">
        {{ 'cart.general.empty' | t }}
      </p>
      <p class="align-center"><a data-cc-animate-click href="{{ continue_shopping_page }}">{{ 'cart.general.continue_browsing' | t }}</a></p>
    </div>
  </div>

  {% endif %}
</div>


{% schema %}
  {
    "name": "Cart page",
    "settings": [
      {
        "type": "checkbox",
        "id": "cart_show_title",
        "label": "Show page title",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "cart_terms_show",
        "label": "Show Terms and Conditions checkbox",
        "info": "Additional checkout buttons will be hidden",
        "default": false
      },
      {
        "type": "url",
        "id": "cart_terms_page",
        "label": "Page for 'Terms and Conditions' link"
      },
      {
        "type": "url",
        "id": "continue_shopping_page",
        "label": "Page for 'Continue shopping' link"
      },
      {
        "type": "checkbox",
        "id": "cart_note_show",
        "label": "Enable order notes",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_tax_and_shipping",
        "label": "Show tax and shipping information",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_additional_checkout_buttons",
        "label": "Show additional checkout options",
        "default": true,
        "info": "Display other gateways and quick checkout buttons. [Read more](https://help.shopify.com/en/manual/payments/accelerated-checkouts)"
      },
      {
        "type": "checkbox",
        "id": "show_backorder_text",
        "label": "Show backorder text",
        "default": true,
        "info": "Only shows for products which use Shopify inventory tracking and are available to purchase when out of stock."
      },
      {
        "type": "checkbox",
        "id": "show_payment_icons",
        "label": "Show payment icon",
        "default": true
      },
      {
        "type": "header",
        "content": "Text"
      },
      {
        "type": "text",
        "id": "checkout_btn",
        "label": "Checkout Button",
        "default": "Continue to Checkout"
      },
      {
        "type": "text",
        "id": "text_summary",
        "label": "Summary",
        "default": "Summary"
      },
      {
        "type": "text",
        "id": "text_total_save",
        "label": "Total Save",
        "default": "Total Save"
      },
      {
        "type": "text",
        "id": "text_total_price",
        "label": "Total price",
        "default": "Estimated Total"
      },
      {
        "type": "richtext",
        "id": "total_price_info",
        "label": "Total price Info",
        "default": "<p>Add promo codes and gift cards at checkout.<br>Taxes and shipping calculated at checkout.</p>"
      }
    ]
  }
{% endschema %}
